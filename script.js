let classInfo = [
  {
    OrgName: "Classcapades",
    className: "BRP - Building Readers Programme (Grade 1)",
    address: "Khar West, Mumbai",
    ageGroupStart: 60,
    ageGroupEnd: 84,
    days: ["Tue", "Thu", "Fri"],
    startDate: "Jun 13, 2023",
    endDate: "Jun 15, 2024",
    categories: ["Language", "Phonics"],
    classType: "Weekly",
    rating: 2,
    img: "1.jpg",
  },
  {
    OrgName: "The Lil Yogi's Club",
    className: "YOGA DISCO TODDLERS",
    address: "Colaba, Mumbai",
    ageGroupStart: 18,
    ageGroupEnd: 96,
    days: ["Tue", "Thu"],
    startDate: "Jun 13, 2023",
    endDate: "Jun 12, 2024",
    categories: ["Sports & Fitness"],
    classType: "Monthly",
    rating: 3,
    img: "2.jpg",
  },
  {
    OrgName: "Magic Beans",
    className: "Magic Beans : The Wonderful World of Jolly Phonics LEVEL 1",
    address: "Tardeo, Mumbai",
    ageGroupStart: 30,
    ageGroupEnd: 60,
    days: ["Mon", "Sat"],
    startDate: "Jun 12, 2023",
    endDate: "Jun 16, 2024",
    categories: ["Phonics"],
    classType: "Sessions",
    rating: 1,
    img: "3.jpg",
  },
  {
    OrgName: "Allrounder",
    className: "Aerial Silk",
    address: "Dadar, Mumbai",
    ageGroupStart: 48,
    ageGroupEnd: 216,
    days: ["Sat", "Sun"],
    startDate: "Jun 12, 2023",
    endDate: "Jun 12, 2024",
    categories: ["Sports & Fitness"],
    classType: "Monthly",
    rating: 5,
    img: "4.jpg",
  },
  {
    OrgName: "Magic Beans",
    className: "Magic Beans Mommy And Me",
    address: "Taedeo, Mumbai",
    ageGroupStart: 10,
    ageGroupEnd: 30,
    days: ["Mon", "Tue", "Wed", "Thu", "Fri"],
    startDate: "Jun 12, 2023",
    endDate: "Jun 19, 2024",
    categories: ["Parent Toddler"],
    classType: "Sessions",
    rating: 3,
    img: "5.jpg",
  },
  {
    OrgName: "The Yoga House Studio & Cafe",
    className: "SHADAJA - A MUSIC PROGRAMME IN BANDRA for Parents & Toddlers",
    address: "Bandra West, Mumbai",
    ageGroupStart: 6,
    ageGroupEnd: 32,
    days: ["Tue"],
    startDate: "Jul 4, 2023",
    endDate: "Jun 4, 2024",
    categories: ["Dance"],
    classType: "Course",
    rating: 4,
    img: "6.jpg",
  },
  {
    OrgName: "Magic Beans",
    className: "Magic Beans Sensory Play",
    address: "Tardeo, Mumbai",
    ageGroupStart: 12,
    ageGroupEnd: 72,
    days: ["Thu"],
    startDate: "Jun 15, 2023",
    endDate: "Jun 14, 2024",
    categories: ["Art & Sensory"],
    classType: "Monthly",
    rating: 4,
    img: "7.jpg",
  },
  {
    OrgName: "Magic Beans",
    className: "Magic Beans Yoga For Kids",
    address: "Tardeo, Mumbai",
    ageGroupStart: 36,
    ageGroupEnd: 72,
    days: ["Tue"],
    startDate: "Jun 13, 2023",
    endDate: "Jun 12, 2024",
    categories: ["Sports & Fitness"],
    classType: "Monthly",
    rating: 3,
    img: "8.jpg",
  },
  {
    OrgName: "Magic Beans",
    className: "Magic Beans - Parent Child RHYME & RHYTHM",
    address: "Tardeo, Mumbai",
    ageGroupStart: 18,
    ageGroupEnd: 60,
    days: ["Mon"],
    startDate: "Jun 12, 2023",
    endDate: "May 12, 2024",
    categories: ["Music"],
    classType: "Sessions",
    rating: 2,
    img: "9.jpg",
  },
  {
    OrgName: "Little Kickers",
    className: "Little Kickers Football",
    address: "Bandra West, Mumbai",
    ageGroupStart: 18,
    ageGroupEnd: 60,
    days: ["Tue", "Wed", "Thu", "Fri"],
    startDate: "Jun 1, 2023",
    endDate: "Jun 30, 2024",
    categories: ["Sports & Fitness"],
    classType: "Quarterly",
    rating: 2,
    img: "10.jpg",
  },
  {
    OrgName: "Little Gym Of Bandra",
    className: "Gymnastics Classes",
    address: "Bandra West, Mumbai",
    ageGroupStart: 19,
    ageGroupEnd: 72,
    days: ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
    startDate: "Jun 1, 2023",
    endDate: "Jun 30, 2024",
    categories: ["Sports & Fitness"],
    classType: "Quarterly",
    rating: 4,
    img: "11.jpg",
  },
  {
    OrgName: "Little Kickers",
    className: "Little Kickers Football",
    address: "Juhu, Mumbai",
    ageGroupStart: 18,
    ageGroupEnd: 60,
    days: ["Mon", "Tue", "Wed", "Thu", "Fri"],
    startDate: "Jun 1, 2023",
    endDate: "Jun 30, 2024",
    categories: ["Sports & Fitness"],
    classType: "Quarterly",
    rating: 2,
    img: "12.jpg",
  },
  {
    OrgName: "Magic Beans",
    className: "Magic Beans BRAIN BOOSTERS",
    address: "Tardeo, Mumbai",
    ageGroupStart: 30,
    ageGroupEnd: 48,
    days: ["Mon", "Wed", "Fri"],
    startDate: "Jun 17, 2023",
    endDate: "Jul 16, 2024",
    categories: ["Language", "Phonics"],
    classType: "Monthly",
    rating: 5,
    img: "13.jpg",
  },
  {
    OrgName: "Allrounders",
    className: "Drawing Classes",
    address: "Dadar, Mumbai",
    ageGroupStart: 36,
    ageGroupEnd: 120,
    days: ["Fri", "Sat"],
    startDate: "Jul 1, 2023",
    endDate: "Jun 30, 2024",
    categories: ["Art & Sensory"],
    classType: "Monthly",
    rating: 3,
    img: "14.jpg",
  },
  {
    OrgName: "Allrounders",
    className: "Keyboard Classes",
    address: "Dadar, Mumbai",
    ageGroupStart: 78,
    ageGroupEnd: 168,
    days: ["Wed"],
    startDate: "Jul 1, 2023",
    endDate: "Jun 30, 2024",
    categories: ["Music"],
    classType: "Monthly",
    rating: 2,
    img: "15.jpg",
  },
  {
    OrgName: "Allrounders",
    className: "Ballet Class",
    address: "Dadar, Mumbai",
    ageGroupStart: 48,
    ageGroupEnd: 144,
    days: ["Tue"],
    startDate: "Jul 1, 2023",
    endDate: "Jun 30, 2024",
    categories: ["Dance"],
    classType: "Monthly",
    rating: 4,
    img: "16.jpg",
  },
  {
    OrgName: "Allrounders",
    className: "Taekwondo Class",
    address: "Dadar, Mumbai",
    ageGroupStart: 60,
    ageGroupEnd: 144,
    days: ["Sat"],
    startDate: "Jul 1, 2023",
    endDate: "Jun 30, 2024",
    categories: ["Sports & Fitness"],
    classType: "Monthly",
    rating: 3,
    img: "17.jpg",
  },
  {
    OrgName: "Allrounder",
    className: "Bollywood Dance Class",
    address: "Dadar, Mumbai",
    ageGroupStart: 96,
    ageGroupEnd: 108,
    days: ["Mon", "Thu"],
    startDate: "Jul 1, 2023",
    endDate: "Jun 30, 2024",
    categories: ["Dance"],
    classType: "Monthly",
    rating: 5,
    img: "18.jpg",
  },
  {
    OrgName: "Yoga With Anindita",
    className: "Yoga With Anindita",
    address: "Santacruz West, Mumbai",
    ageGroupStart: 36,
    ageGroupEnd: 84,
    days: ["Sun"],
    startDate: "Jul 1, 2023",
    endDate: "Jun 30, 2024",
    categories: ["Sun"],
    classType: "Sports & Fitness",
    rating: 4,
    img: "19.jpg",
  },
  {
    OrgName: "Gehna Mirchandani",
    className: "Gehna's Jolly Classes",
    address: "Bandra West, Mumbai",
    ageGroupStart: 36,
    ageGroupEnd: 60,
    days: ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
    startDate: "Jul 1, 2023",
    endDate: "Jun 30, 2024",
    categories: ["Art & Sensory", "Phonics"],
    classType: "Monthly",
    rating: 0,
    img: "20.jpg",
  },
];

$(document).ready(function () {
  updateClassList();
});

let ageFilter = [];

function updateClassList() {
  let filterObj = {};
  ageFilter.length > 0 ? (filterObj.ageFilter = `${ageFilter[0]}-${ageFilter[1]}`) : (filterObj.ageFilter = ``);
  const classContainer = document.getElementById("classes");
  classContainer.innerHTML = "";
  classInfo.forEach((element) => {
    let OrgName = element.OrgName;
    let className = element.className;
    let address = element.address;
    let ageGroupStart = element.ageGroupStart;
    let ageGroupEnd = element.ageGroupEnd;
    let days = element.days;
    let startDate = element.startDate;
    let endDate = element.endDate;
    let categories = element.categories;
    let classType = element.classType;
    let rating = element.rating;
    let img = element.img;

    debugger;
    // console.log(filterObj.ageFilter)
    if (filterObj.ageFilter.length > 0) {
      let start = parseInt(filterObj.ageFilter.split("-")[0]);
      let end = parseInt(filterObj.ageFilter.split("-")[1]);
      // console.log(typeof start, start, typeof end, end);
      // start >= ageGroupStart?(end <= ageGroupEnd? '': return ):return;
      // debugger;
      if ((start >= ageGroupStart && start <= ageGroupEnd) || (end >= ageGroupStart && end <= ageGroupEnd)) {
        console.log("class printed");
      } else {
        return;
      }
    }

    classContainer.innerHTML += `
        <div class='card mb-3'>
                <div class='row g-0'>
                  <div class='col-lg-3 col-xl-2 align-items-center d-flex'>
                    <img src='/src/${img}' class='img-fluid' alt='Class Thumbnail' />
                  </div>
                  <div class='col-lg-9 col-xl-8'>
                    <div class='card-body'>
                      <p class='class-name mb-1'><small class='text-body-secondary'>${OrgName}</small></p>
                      <h5 class='card-title mb-2'>${className}</h5>
                      <div class='row mb-2'>
                        <div class='col-md-6'>
                          <p class='card-text address mb-1'>${address}</p>
                          <p class='card-text days'>${getDaysString(days)}</p>
                        </div>
                        <div class='col-md-6'>
                          <p class='card-text mb-1'>Age: ${getAgeString(ageGroupStart)} - ${getAgeString(ageGroupEnd)}</p>
                          <p class='card-text mb-0'>${startDate} - ${endDate}</p>
                        </div>
                      </div>
                      <div class='class-category'>
                        <span class='badge rounded-pill'>${categories[0]}</span>
                        <span class='extra-category'>${getCategory(categories)}</span>
                      </div>
                    </div>
                  </div>
                  <div class='col-lg-12 col-xl-2'>
                    <div class='card-body h-100 d-flex flex-column justify-content-between text-end'>
                      <div class='rating'>${giveRating(rating)}</div>
                      <div class='class-type'>
                        <p>${classType}</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
        `;
  });
}

function getDaysString(daysArray) {
  let dayString = "";
  if (daysArray.length === 1) {
    return daysArray[0];
  }
  daysArray.forEach((element) => {
    dayString += element + " ";
  });
  dayString = dayString.slice(0, -1);
  return dayString;
}

function getAgeString(months) {
  // let ageString = (start / 12 >= 1) ? (start % 12 === 0) ? (` - ${start/12}yrs`) :(` - ${Math.floor(start/12)}yrs ${start%12}Mo` ): ` - ${start%12}Mo`;
  // ageString += (end / 12 >= 1) ? (end % 12 === 0) ? (` - ${end/12}yrs`) :(` - ${Math.floor(end/12)}yrs ${end%12}Mo` ): ` - ${end%12}Mo`;
  let ageString = months / 12 >= 1 ? (months % 12 === 0 ? ` ${months / 12}yrs` : ` ${Math.floor(months / 12)}yrs ${months % 12}Mo`) : ` ${months % 12}Mo`;
  return ageString;
}

function getCategory(categories) {
  let noOfCategories = categories.length > 1 ? `+${categories.length - 1}` : ``;
  return noOfCategories;
}

function giveRating(stars) {
  let starHtml = "";
  for (let i = 1; i <= 5; i++) {
    if (i <= stars) {
      starHtml += `<i class='bi bi-star-fill'></i>`;
    } else {
      starHtml += `<i class='bi bi-star'></i>`;
    }
  }
  return starHtml;
}

function updateModal(flag) {
  document.getElementById("modalName").innerText = capitalize(flag);
  document.getElementById("filterModal").setAttribute("data-flag", flag);
  switch (flag) {
    case "age":
      getModalForAge();
      break;

    case "category":
      getModalForCategory();
      break;

    case "day":
      getModalForDay();
      break;

    case "class Type":
      getModalForClassType();
      break;
  }
}

function clearFilter() {
  // document.getquerySelectorAll(".active-ageGroup");
  let flag = document.getElementById("filterModal").getAttribute("data-flag");
  switch (flag) {
    case "age":
      document.querySelectorAll(".active-ageGroup").length > 0 ? document.querySelectorAll(".active-ageGroup")[0].classList.remove("active-ageGroup") : "";
      break;
    case "category":
      document.querySelectorAll(".form-check-input").forEach((element) => {
        element.checked = false;
      });
      break;
    case "day":
      document.querySelectorAll(".form-check-input").forEach((element) => {
        element.checked = false;
      });
      break;
    case "class Type":
      document.querySelectorAll(".form-check-input").forEach((element) => {
        element.checked = false;
      });
      break;
  }
}

function getModalForAge() {
  const modalBody = document.getElementById("modal-body");
  modalBody.innerHTML = `
  <div class='row g-3'>
              <div class='col-xl-4 col-lg-6'>
              <button data-value='0-6' class='age-filter-btn'>0 - 6 Months</button>
              </div>
              <div class='col-xl-4 col-lg-6'>
              <button data-value='6-12' class='age-filter-btn'>6 - 12 Months</button>
              </div>
              <div class='col-xl-4 col-lg-6'>
                <button data-value='12-18' class='age-filter-btn'>12 - 18 Months</button>
                </div>
                <div class='col-xl-4 col-lg-6'>
                <button data-value='18-24' class='age-filter-btn'>18 - 24 Months</button>
                </div>
                <div class='col-xl-4 col-lg-6'>
                <button data-value='24-48' class='age-filter-btn'>2 - 4 Years</button>
                </div>
                <div class='col-xl-4 col-lg-6'>
                <button data-value='48-72' class='age-filter-btn'>4 - 6 Years</button>
                </div>
                <div class='col-xl-4 col-lg-6'>
                <button data-value='72-96' class='age-filter-btn'>6 - 8 Years</button>
                </div>
              <div class='col-xl-4 col-lg-6'>
              <button data-value='96-120' class='age-filter-btn'>8 - 10 Years</button>
              </div>
              <div class='col-xl-4 col-lg-6'>
                <button data-value='120-144' class='age-filter-btn'>10 - 12 Years</button>
                </div>
              <div class='col-xl-4 col-lg-6'>
              <button data-value='144-168' class='age-filter-btn'>12 - 14 Years</button>
              </div>
              <div class='col-xl-4 col-lg-6'>
              <button data-value='168-192' class='age-filter-btn'>14 - 16 Years</button>
              </div>
              <div class='col-xl-4 col-lg-6'>
              <button data-value='193-1200' class='age-filter-btn'>&gt;16 Years</button>
              </div>
              </div>
              `;
  if (ageFilter.length > 0) {
    const ageFilterStr = `${ageFilter[0]}-${ageFilter[1]}`;
    // $('.age-filter-btn').forEach(element => {
    //   console.log(element);
    // });
    $(`[data-value=${ageFilterStr}]`).addClass("active-ageGroup");
    // console.log($('.age-filter-btn').attr('data-value'));
  }
  const ageFilterBtn = document.querySelectorAll(".age-filter-btn");
  ageFilterBtn.forEach(function (button) {
    button.addEventListener("click", function (e) {
      if (document.querySelectorAll(".active-ageGroup").length !== 0) {
        document.querySelectorAll(".active-ageGroup")[0].classList.remove("active-ageGroup");
      }
      e.target.classList.add("active-ageGroup");
    });
  });
}

function getModalForCategory() {
  const modalBody = document.getElementById("modal-body");
  modalBody.innerHTML = `
  <div class='row'>
  <div class='col-6'>
  <input class='form-check-input' type='checkbox' value='dance' id='dance'>
  <label class='form-check-label' for='dance'>
    Dance
  </label>
</div>
<div class='col-6'>
  <input class='form-check-input' type='checkbox' value='language' id='language'>
  <label class='form-check-label' for='language'>
    Language
  </label>
</div>
<div class='col-6'>
  <input class='form-check-input' type='checkbox' value='writing' id='writing'>
  <label class='form-check-label' for='writing'>
    Writing
  </label>
</div>
<div class='col-6'>
  <input class='form-check-input' type='checkbox' value='music' id='music'>
  <label class='form-check-label' for='music'>
    Music
  </label>
</div>
<div class='col-6'>
  <input class='form-check-input' type='checkbox' value='parentoddler' id='parentoddler'>
  <label class='form-check-label' for='parentoddler'>
    Parent Toddler
  </label>
</div>
<div class='col-6'>
  <input class='form-check-input' type='checkbox' value='storytelling' id='storytelling'>
  <label class='form-check-label' for='storytelling'>
    Story Telling
  </label>
</div>
<div class='col-6'>
  <input class='form-check-input' type='checkbox' value='stem' id='stem'>
  <label class='form-check-label' for='stem'>
    STEM
  </label>
</div>
<div class='col-6'>
  <input class='form-check-input' type='checkbox' value='coding' id='coding'>
  <label class='form-check-label' for='coding'>
    Coding
  </label>
</div>
<div class='col-6'>
  <input class='form-check-input' type='checkbox' value='artsensory' id='artsensory'>
  <label class='form-check-label' for='artsensory'>
    Art & Sensory
  </label>
</div>
<div class='col-6'>
  <input class='form-check-input' type='checkbox' value='phonics' id='phonics'>
  <label class='form-check-label' for='phonics'>
    Phonics
  </label>
</div>
<div class='col-6'>
  <input class='form-check-input' type='checkbox' value='sportsfitness' id='sportsfitness'>
  <label class='form-check-label' for='sportsfitness'>
    Sports & Fitness
  </label>
</div>
</div>
  `;
}

function getModalForDay() {
  const modalBody = document.getElementById("modal-body");
  modalBody.innerHTML = `
  <div class='row'>
  <div class='col-6'>
    <input class='form-check-input' type='checkbox' value='Mon' id='Mon' />
    <label class='form-check-label' for='Mon'> Monday </label>
  </div>
  <div class='col-6'>
    <input class='form-check-input' type='checkbox' value='Tue' id='Tue' />
    <label class='form-check-label' for='Tue'> Tuesday </label>
  </div>
  <div class='col-6'>
    <input class='form-check-input' type='checkbox' value='Wed' id='Wed' />
    <label class='form-check-label' for='Wed'> Wednesday </label>
  </div>
  <div class='col-6'>
    <input class='form-check-input' type='checkbox' value='Thu' id='Thu' />
    <label class='form-check-label' for='Thu'> Thursday </label>
  </div>
  <div class='col-6'>
    <input class='form-check-input' type='checkbox' value='Fri' id='Fri' />
    <label class='form-check-label' for='Fri'> Friday </label>
  </div>
  <div class='col-6'>
    <input class='form-check-input' type='checkbox' value='Sat' id='Sat' />
    <label class='form-check-label' for='Sat'> Saturday </label>
  </div>
  <div class='col-6'>
    <input class='form-check-input' type='checkbox' value='Sun' id='Sun' />
    <label class='form-check-label' for='Sun'> Sunday </label>
  </div>
</div>
  `;
}

function getModalForClassType() {
  const modalBody = document.getElementById("modal-body");
  modalBody.innerHTML = `
  <div class='row'>
  <div class='col-6'>
    <input class='form-check-input' type='checkbox' value='sessions' id='sessions' />
    <label class='form-check-label' for='sessions'> Sessions </label>
  </div>
  <div class='col-6'>
    <input class='form-check-input' type='checkbox' value='monthly' id='monthly' />
    <label class='form-check-label' for='monthly'> Monthly </label>
  </div>
  <div class='col-6'>
    <input class='form-check-input' type='checkbox' value='weekly' id='weekly' />
    <label class='form-check-label' for='weekly'> Weekly </label>
  </div>
  <div class='col-6'>
    <input class='form-check-input' type='checkbox' value='course' id='course' />
    <label class='form-check-label' for='course'> Course </label>
  </div>
  <div class='col-6'>
    <input class='form-check-input' type='checkbox' value='quarterly' id='quarterly' />
    <label class='form-check-label' for='quarterly'> Quarterly </label>
  </div>
</div>
  `;
}

function capitalize(word) {
  return word.charAt(0).toUpperCase() + word.slice(1);
}

function applyFilter() {
  let flag = document.getElementById("filterModal").getAttribute("data-flag");
  switch (flag) {
    case "age":
      filterWithAge();
      break;

    case "category":
      filterWithCategory();
      break;

    case "day":
      filterWithDay();
      break;

    case "class Type":
      filterWithClassType();
      break;
  }
}

function filterWithAge() {
  if ($(".active-ageGroup").length > 0) {
    // console.log($(".active-ageGroup")[0].dataset.value.split("-")[0]);
    let start = $(".active-ageGroup")[0].dataset.value.split("-")[0];
    let end = $(".active-ageGroup")[0].dataset.value.split("-")[1];
    ageFilter.push(start);
    ageFilter.push(end);
    // debugger;
    $("#age-filter-btn").attr("data-filter", `${start}-${end}`);
    $("#agefilter").html(`${getAgeString(start)} - ${getAgeString(end)} <button><i onclick='clearAgeFilter()' class='bi bi-x'></i></button>`);
    // console.log($("#agefilter"));
    $("#agefilter").css({ display: "inline-block" });
    $("#age-filter-btn").css({ "background-color": "#f99e24", color: "white" });
    $(".btn-close").click();
    updateClassList();
  } else {
    clearAgeFilter();
  }
}

function filterWithCategory() {}

function filterWithDay() {}

function filterWithClassType() {}

function clearAgeFilter() {
  ageFilter = [];
  $("#agefilter").css({ display: "none" });
  $("#age-filter-btn").css({ "background-color": "#fff", color: "black" });
  $("#age-filter-btn").removeAttr("data-filter");
  updateClassList();
}
